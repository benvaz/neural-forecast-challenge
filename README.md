# Neural Signal Forecasting - HDR SMood Challenge Y2

Submission for the Neural Signal Forecasting track of the [2025 HDR Scientific Mood Challenge](https://www.nsfhdr.org/html/mlchallenge-y2/).

## Approach

Multi-component ensemble combining Ridge regression variants with Koopman operator corrections for neural signal forecasting. The model predicts 10 future timesteps from 10 observed timesteps across multiple cortical recording channels.

### Components
- **NeighborRidge (NB):** Per-channel Ridge using K most-correlated neighbor channels as features
- **MultiBand (MB):** Ridge on 6 summary statistics per channel per frequency band
- **RAW:** Ridge on raw temporal values across all bands
- **Koopman:** PCA-based latent dynamics correction on persistence forecast

### Inference Architecture
- Variance-based routing splits test batches into day-specific (d1) and private (priv) paths
- Per-timestep blending via `blend_t` arrays allows time-varying component weights
- Separate weight optimization for each path

## Repository Structure
```
baselines/
  submissions/neural_forecast_blend/
    model.py              # Inference model (submitted to CodaBench)
    requirements.txt
  training/neural_forecast_blend/
    train_blend.py        # Core training: Ridge + Koopman per monkey
    validate.py           # Local validation script
    phase1_build.py       # Advanced component training and submission builder
```

### Model Weights

Weights are not included in this repository due to size (~450MB). They are generated by running:
```bash
cd baselines/training/neural_forecast_blend
python train_blend.py
```

Training data is available from the competition organizers.

## Installation
```bash
pip install numpy scikit-learn
```

## Training
```bash
python baselines/training/neural_forecast_blend/train_blend.py
```

## References

- Competition: [Neural Signal Forecasting Challenge](https://www.codabench.org/competitions/9854/)
